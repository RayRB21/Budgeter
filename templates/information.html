{% extends 'base.html' %}

{% block head %}
<title>Information</title>
{% endblock %}

{% block body %}
<div class = "Info">
    <h1>Hello {{ session["user"].capitalize() }}</h1>
    <h3>These are {{month_name}}'s analytics</h3>
</div>

<!--Piecharts-->
<div style="height:50%" class="d-flex justify-content-center gap-5">
    <canvas id="myPieChart"  style="margin-right:5%"></canvas>
    <canvas id="myPieChart2"  style="margin-left:5%"></canvas>
</div>
<!----------------------------------------------------------------------------------->

<!--Linecharts-->
<div style="height: 50%" class="d-flex justify-content-center">
  <canvas id="LineChart"></canvas>
</div>
<!----------------------------------------------------------------------------------->



<!--Barcharts-->
<div style="height: 50%;" class="d-flex justify-content-center">
  <canvas id="BarChart" ></canvas>
</div>
<!----------------------------------------------------------------------------------->



 
<script>
  //Piecharts JS--------------
  const sLabel = {{ month_spending_labels | tojson }};
  const sValues = {{ month_spending_values | tojson }};
  
  new Chart(document.getElementById('myPieChart'), {
    type: 'pie',
    data: {
      labels: sLabel,
      datasets: [{ data: sValues }]
    },
    options: {
        plugins:{
        title: {
            display: true,
            text: "Spending (£)",
            font: {
                size: 20
            }
        }
        }
    }
  });
  
  const iLabel = {{ month_income_labels | tojson }}; 
  const iValues = {{ month_income_values | tojson }};
  
  new Chart(document.getElementById('myPieChart2'), {
    type: 'pie',
    data: {
      labels: iLabel,
      datasets: [{ data: iValues }]
    },
    options: {
        plugins: {
        title: {
            display: true,
            text: "Income (£)",
            font: {
                size: 20
            }
        }
        }
    }
  });
//------------------------------------------------------------------------------------

//Linegraphs JS-------------------------------------
  const lineLabels = {{ days | tojson }};
  const lineValues = [3000,3000,3000,3000,3000,3000,2400,2400,2400,2400,2400,2400,2400,2400,2400,1400,1400,1400,1400,1400,2200,2200,2200,2200,2200,2200,2200,2900,2900,2900,1000]

  new Chart(document.getElementById('LineChart'),{
    type: 'line',
    data: {
      labels: lineLabels,
      datasets: [{
        label: "Balance(£)",
        data: lineValues,
        borderColor: "black",
        backgroundColor: "rgba(32, 110, 16, 0.8)",
        tension: 0.1,
        fill:true
      }]
    },
    options: {
      scales: {
        y:{
          beginAtZero: true
        }
      },
      responsive: true,
      plugins: {
        legend: { position: 'top' },
        title: {
          display: true,
          text: 'Balance Trend Over August'
        }
      }
    }
  });
//------------------------------------------------------------------------------------





//Barcharts JS-------------------------------------
  const weekBarLabels = ["Week 1","Week 2","Week 3", "Week 4","Week 5"];
  //const weekSpend = {{ weekSpend | tojson }};
  //const weekIncome = {{ weekIncome | tojson }};
  new Chart(document.getElementById('BarChart'),{
    type: 'bar',
    data: {
      labels: weekBarLabels,
      datasets: [
      { 
        label: "Income",
        data: {{ weekIncome }},
        backgroundColor: ["green"],
        borderWidth: 1 
      },
      {
        label: "Spending",
        data: {{ weekSpend }},
        backgroundColor: ["red"],
        borderWidth : 1
      }
      ]
    },
    options: {
      scales: {
        y:{
          beginAtZero: true
        }
      },
      plugins: {
        legend: { position: 'top'},
        title:{
          display: true,
          text: 'Income vs Expenses of ' + "{{month_name}}",
        }
      }
    }
  });
//------------------------------------------------------------------------------------
</script>
{% endblock %}